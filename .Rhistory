?loess
NOx = c(4.818, 2.849, 3.275, 4.691, 4.255, 5.064, 2.118, 4.602,
2.286, 0.97, 3.965, 5.344, 3.834, 1.99, 5.199, 5.283,
3.752, 0.537, 1.64, 5.055, 4.937, 1.561)
E = c(0.831, 1.045, 1.021, 0.97, 0.825, 0.891, 0.71, 0.801,
1.074, 1.148, 1, 0.928, 0.767, 0.701, 0.807, 0.902,
0.997, 1.224, 1.089, 0.973, 0.98, 0.665)
loess(NOx ~ E)
getAnywhere(loess)
getAnywhere(simpleLoess)
NOx = c(4.818, 2.849, 3.275, 4.691, 4.255, 5.064, 2.118, 4.602,
2.286, 0.97, 3.965, 5.344, 3.834, 1.99, 5.199, 5.283,
3.752, 0.537, 1.64, 5.055, 4.937, 1.561)
E = c(0.831, 1.045, 1.021, 0.97, 0.825, 0.891, 0.71, 0.801,
1.074, 1.148, 1, 0.928, 0.767, 0.701, 0.807, 0.902,
0.997, 1.224, 1.089, 0.973, 0.98, 0.665)
loess(NOx ~ E)
loess(NOx ~ E, family = "gaussian")
loess(NOx ~ E, family = "gaussian", span = 0.75)
loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 2)
loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 1)
loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 0)
loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 2)
loess(E ~ NOx, family = "gaussian", span = 0.75, degree = 2)
loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 0, cell = 0.2)
loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 2, cell = 0.2)
loess(NOx ~ E, family = "gaussian", span = 2/3, degree = 2, cell = 0.2)
NOx = c(4.818, 2.849, 3.275, 4.691, 4.255, 5.064, 2.118, 4.602,
2.286, 0.97, 3.965, 5.344, 3.834, 1.99, 5.199, 5.283,
3.752, 0.537, 1.64, 5.055, 4.937, 1.561)
E = c(0.831, 1.045, 1.021, 0.97, 0.825, 0.891, 0.71, 0.801,
1.074, 1.148, 1, 0.928, 0.767, 0.701, 0.807, 0.902,
0.997, 1.224, 1.089, 0.973, 0.98, 0.665)
loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 2)
l = loess(NOx ~ E, family = "gaussian", span = 0.75, degree = 2)
l$fitted
predict(l, se=TRUE)
p = predict(l, se=TRUE)
p
p$fit + p$se.fit
p$fit - p$se.fit
predict
?predict.loess
plot(cars)
plx<-predict(loess(cars$dist ~ cars$speed), se=T)
lines(cars$speed,plx$fit)
lines(cars$speed,plx$fit - qt(0.975,plx$df)*plx$se, lty=2)
lines(cars$speed,plx$fit + qt(0.975,plx$df)*plx$se, lty=2)
setwd("~/git/cxplot")
source("~/git/cxplot/cxplot.R")
ggplot2(cars, aes(speed, dist)) + geom_point() + geom_smooth()
library(ggplot2)
ggplot2(cars, aes(speed, dist)) + geom_point() + geom_smooth()
ggplot(cars, aes(speed, dist)) + geom_point() + geom_smooth()
cxplot(ggplot(cars, aes(speed, dist)) + geom_point() + geom_smooth())
lls=loess(cars$dist ~ cars$speed)
sort(lls$fitted)
NOx = c(4.818, 2.849, 3.275, 4.691, 4.255, 5.064, 2.118, 4.602,
2.286, 0.97, 3.965, 5.344, 3.834, 1.99, 5.199, 5.283,
3.752, 0.537, 1.64, 5.055, 4.937, 1.561)
E = c(0.831, 1.045, 1.021, 0.97, 0.825, 0.891, 0.71, 0.801,
1.074, 1.148, 1, 0.928, 0.767, 0.701, 0.807, 0.902,
0.997, 1.224, 1.089, 0.973, 0.98, 0.665)
lls = loess(NOx ~ E)
sort(lls$fitted)
lls
lls$fitted
sort(lls$fitted)
lls$fitted
flx = predict(lls, se=T)
flx$se.fit
sort(flx$se.fit)
